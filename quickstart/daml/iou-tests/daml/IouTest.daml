module IouTest where

import Daml.Script
import IouTemplate.Iou

iou_test : Script ()
iou_test = do
  alice <- allocateParty "Alice"
  bob <- allocateParty "Bob"

  -- Alice and Bob enter into a trade.
  -- Alice wants to give Bob an Iou, but she can't without Bob's authority.
  alice_bob_iou <- submit alice do
    createCmd IouHolding with
      issuer = alice
      owner = bob
      amount = 100.0
      currency = "USD"
      observers = [alice, bob]

  -- She can issue herself an Iou.
  iou <- submit alice do
    createCmd IouHolding with
      issuer = alice
      owner = alice
      amount = 100.0
      currency = "USD"
      observers = [alice]

  -- -- However, she can't transfer it to Bob.
  -- submitMustFail alice do
  --   exerciseCmd iou Transfer with
  --     newOwner = bob

  return ()